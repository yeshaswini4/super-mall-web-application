<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - SuperMall</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="static/css/main.css">
    <link rel="stylesheet" href="static/css/components.css">
    <style>
        .product-detail { max-width: 1200px; margin: 100px auto; padding: 20px; }
        .product-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
        .product-image { width: 100%; border-radius: 12px; }
        .product-info h1 { margin-bottom: 20px; }
        .price { font-size: 36px; font-weight: 700; color: #667eea; margin: 20px 0; }
        .features { list-style: none; padding: 0; margin: 20px 0; }
        .features li { padding: 10px 0; border-bottom: 1px solid #e2e8f0; }
        .btn { padding: 12px 24px; margin-right: 10px; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; }
        .btn-primary { background: #667eea; color: white; }
        .btn-secondary { background: #e2e8f0; color: #2d3748; }
        .stock { color: #38a169; font-weight: 600; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-left">
            <span class="logo-text">ðŸ›’ SuperMall</span>
        </div>
        <div class="nav-right">
            <a href="index.html">Home</a>
            <a href="shop_list.html">Shops</a>
            <a href="compare.html">Compare <span id="compareBadge" style="background:#e53e3e;color:white;padding:2px 6px;border-radius:10px;font-size:12px;display:none;">0</span></a>
            <a href="cart.html" style="position:relative;">ðŸ›’ Cart <span id="cartBadge" style="position:absolute;top:-5px;right:-10px;background:#e53e3e;color:white;border-radius:50%;width:20px;height:20px;font-size:12px;display:none;align-items:center;justify-content:center;">0</span></a>
            <a href="login.html" class="btn-primary">Login</a>
        </div>
    </nav>

    <div class="product-detail">
        <div class="product-grid">
            <div>
                <img id="productImage" class="product-image" src="" alt="">
            </div>
            <div class="product-info">
                <h1 id="productName"></h1>
                <div class="price" id="productPrice"></div>
                <p class="stock" id="productStock"></p>
                <p id="productDesc"></p>
                
                <h3>Features:</h3>
                <ul class="features" id="productFeatures"></ul>

                <div style="margin-top: 30px;">
                    <button class="btn btn-primary" onclick="addToCart()">Add to Cart</button>
                    <button class="btn btn-secondary" onclick="addToCompare()">Add to Compare</button>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <p>Â© 2025 SuperMall â€” Your Smart Shopping Destination</p>
    </footer>

    <script src="static/js/config.js"></script>
    <script src="static/js/auth.js"></script>
    <script src="static/js/cart.js"></script>
    <script src="static/js/product.js"></script>
    <script>
        let currentProduct = null;

        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = parseInt(urlParams.get('id'));

            await productManager.loadProducts();
            currentProduct = productManager.getProduct(productId);

            if (currentProduct) {
                displayProduct(currentProduct);
            } else {
                alert('Product not found');
                window.location.href = 'shop_list.html';
            }

            productManager.updateCompareUI();
        });

        function displayProduct(product) {
            document.getElementById('productName').textContent = product.name;
            document.getElementById('productPrice').textContent = `$${product.price}`;
            document.getElementById('productStock').textContent = `In Stock: ${product.stock} units`;
            document.getElementById('productDesc').textContent = product.description || 'High quality product';
            document.getElementById('productImage').src = product.image;
            
            const featuresList = document.getElementById('productFeatures');
            featuresList.innerHTML = product.features.map(f => `<li>âœ“ ${f}</li>`).join('');
        }

        function addToCart() {
            if (cartService.addToCart(currentProduct)) {
                alert('Added to cart!');
            }
        }

        function addToCompare() {
            if (!authService.isAuthenticated()) {
                alert('Please login to compare products');
                window.location.href = 'login.html';
                return;
            }
            if (productManager.addToCompare(currentProduct.id)) {
                authService.logAction('add_to_compare', authService.currentUser?.role || 'guest', 'product', currentProduct.id);
                alert('Added to comparison!');
            }
        }
    </script>
</body>
</html>
